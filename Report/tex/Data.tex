\chapter{Data}


\section{Overview of the HES Dataset}
The data used in this project comes from The Household Electricity Survey (HES), a study sponsored by DEFRA to monitor the electrical power demand and energy consumption of individual households in England over the period May 2010 to July 2011 \cite{HES}. The aim was to identify and catalogue the range and quantity of electrically-powered appliances found in a typical home, understand households' frequency and patterns of electricity usage, and collect `user habit' data that emerges from recording a range of appliances \cite{early_findings}.

The HES study monitored 250 households, of which 26 were observed for one year with the remaining 224 monitored for roughly one month. Not every household had the same number of appliances being monitored. The number was in the range of 13 to 85 appliances per home. When aggregated, (as outlined in section \aggregationSection), the result could considered an estimate of a mains reading. Depending on the household, measurements were either taken in  2 or 10 minute intervals with units of deci-Watt hours (0.1Wh). 

In addition to data regarding the appliance types and data readings, participating households also kept diaries of how they used their main appliances and provided supplemental information about the household, such as, the number of occupants, employment status, Ipsos social-grade and whether there were children present in the household.


\section{Extracting the Data and Pre-Processing}

As explained in Section \mentionOfAggregationSection, electricity readings of individual appliances and sockets were taken for each household (as opposed to total energy consumed by the household, as was required for this project). The HES study recorded measurements for the 250 possible appliances that a household could have (giving values of 0 to appliances that were not present in a household). The resulting raw data was held in large csv files with a significant number of redundant entries. In order to use the data to perform data mining, numerous pro-processing steps needed to be performed as explained here. Each of these steps were performed by writing python scripts with embedded SQL.

The first step in pre-processing the data was to create a MySQL database and import the appliance readings into a table. Cambridge Architectural Research Ltd \cite{CARG_1} provided additional files that mapped which appliances needed to be aggregated for each household in order to produce an estimate for the mains reading. This was often not simply the sum of all appliances readings. A table was therefore created for every household where each row contained the aggregated electricity measurements for a given date and time. 

250 households in England participated in the HES study, a relatively small number for a machine learning task as there might not be enough data to build models that accurately sample the population. To help account for this, the 26 households that were monitored for an entire year were split into 12 instances that could be treated as separate households, resulting in an additional 281 household instances. While this does not create a more diverse group, it does add more instances to train, validate and test a classifier with. To avoid overfitting the classification models to the data, all instances from a given household were either in the training or test set, but never both.

Next, the inconsistency in measurement intervals was accounted for. While some households reported how much energy they used in 10 minute intervals, others were measured in 2 minute intervals. To create consistency in the data, for the `2-minute households', every five intervals were summed so that all households had 10 minute granularity. This step was important since some consumption features, would have been affected by differences in measurement intervals. Once all households were represented in 10-minute intervals with units of 0.1Wh (deci Watt hours), each reading was then multiplied by 0.6 to convert the data to Watts.

The last stage in pre-processing was to ensure that each instance was of the same length. As will be discussed in chapter \ref{ch:Features}, temporal structure was observed both intraday and intraweek. Therefore, the time series instances were manipulated so that each had a length of 28 days and started on the same day of the week. This was done by performing the following steps:

\begin{enumerate}
\item Ensure that each household has an integer number of days by topping and tailing the data.
\item Find the mode day of the week that the data starts from (which was found to be Sunday).
\item For the households that do not begin on a Sunday, chop the top few days so that the data begins on a Sunday.
\item If the household's data is now less that 28 days, append days to the end until it is of the correct length. If it is possible, use the days that were chopped off in the previous step, otherwise, reuse a days worth of readings.
\end{enumerate}

Figure \ref{fig:preProcess} gives a visual example of the data is made to be of uniform length. As the readings start on a Thursday (day 5), the first three days are chopped off the top. Since the data is now less that the required number of days, days are either reused or, is possible, taken from the days that have been chopped from the top.
\to28days

\section{Household Classes}

Each household that participated in the HES study completed a survey with questions about the building being occupied (such as the year the house was built), the household (such as the number of occupants) as well as the occupants' attitude towards climate change and energy consumption. The answers to these questions are used as labels for the households to perform supervised learning.

\sgTable

Tables \ref{tab:sgTable} and \ref{tab:childTable} show the sample sizes for each class of the two classification problems being concidered in this project. The distribution of households over each of the classes in our sample is similar to the true distribution, which means that the empirical prior probability of each class is a reasonable estimate of the true prior probability. However, there is a significant imbalance in the classes, especially in the socio-economic classes. This result in bias in the classification models that will need to be considered when evaluating them.
\childTable

\section{Data Visualisation}

After the data had been extracted from the csv files, pre-processed and imported into MATLAB, plots of the data were made in order to visually gain insight into how households used energy and increase domainn knowlege. Figures \ref{fig:household369OneWeek} and \ref{fig:household369} are examples of how some of the households consumed energy. Both figures show the data gathered from the same households, but over different time periods. Studying these plots gives valuable insight into the households which is used later to aid in feature extraction, as well as ensure that the data appears reasonable. 

In figure \ref{fig:household369OneWeek}, the first thing to be noted is that the consumption is not smooth. There are sharp peaks that vary in height, which can be used to make assumptions about which appliances are being used. For example, many of the peaks  are around 1kW, which is roughly the amount of power used by a kettle. The next thing to note is that there is an obvious underlying daily repetition. The household tends to use more electricity at night than it does during the day time. Finally, it can be seen that the energy consumption on weekends is slightly different than that of week days, particularly, there are short periods of abnormally high electricity on Saturdays and Sundays which are observed less frequently during the week. To see this, note that both figure \ref{fig:household369OneWeek} and \ref{fig:household369} start on a Sunday, and that each `wavelet' is one day long.

It is a result of these observations that the data was made to be four weeks long. Ensuring that each day of the week appears exactly 4 times for each household means that features such as the total energy used is not influenced by which days of the week are present.

\householdOneWeek
\householdPlot




\section{Issues}

As with any study, numerous issues arose with the data that needed to be acknowledged. While some of these are simply the result of environmental issues, others relate more to the way the study was conducted. While those most relevant to this project are outlined below, others can be found in the CAR report \cite{early_findings}

The first problem with the data is the number of households that participated in the HES study. Only 250 individual households took part. Comparing this to the 4232 households that took part in the CER\footnote{www.ucd.ie/issda/data/commissionforenergyregulationcer/} (Commission for Energy Regulation) study of household electricity consumption in Ireland (used by  Beckel et. al. and McLoughlin \cite{Beckel_1,Beckel_2,Beckel_3,McLoughlin}), it is less likely that the results generalise as well, particularly for the multi-class classification problem where there are as few as 32 households in a class. Moreover, only households in England took part in the study, and all of them were owner occupied. This means that the subset of homes considered in the HES study is not fully representative of the UK as a whole, since 84\% of people in the UK live in England and only 64\% of homes in England are owner occupied \cite{ONS}. The aim of this project, however, is to determine \textit{whether it is possible} to infer household properties from a household's electrical power consumption, not to build a classifier that can be used to infer British household properties from smart meter data. The distinction being that this project is a proof of concept and looks at whether information about a household is contained in they energy use patterns rather than to build a commercial product. Therefore, the quality of the sample population (or lack thereof) households is not detrimental to the aims of this project.

A more bothersome issue is the quality of data that gathered during the HES study. While household shown in figure \ref{fig:household369} shows the characteristics of a typical home's consumption well, it is one of the `better' households in the sample. There are many others that no not follow the same kind of trend such as those in figure \ref{fig:badHouseholds}. Either they do not have the same well-defined periodicity, or they may use significantly more (or less) energy than the average household. The task then becomes determining whether these discrepancies are reasonable differences that could be attributed to differences between households, or whether they are the result of poorly executed data collection. Since the HES study involved recording individual appliances, rather than the mains reading of a household, the total energy consumed by each household can not be given with certainty as it is not known if all appliances and sockets in a household were recorded. This is made evident in figure \ref{fig:badHouseholds} where household \#75 is always using at least some energy while household \#121 sees its consumption drop to 0. Household \#75 is a better estimate as it is reasonable that there will always be a small amount of electricity used by a home since the appliances are not 100\% efficient and leak electricity.

\badHouseholds

Table \ref{tab:applianceTable}, is taken from the Center for Sustainable Energy \cite{CSE} and shows how much power various appliances use. Comparing these values to the data from the meter readings shows that it is reasonable to see a household use  anywhere from 50W to upwards of 15,000W at a time. However, it is also noted that some of the expensive appliances (which will have large effects on a households consumption) will not be present in all households. These include electric cookers, electric showers, electric heaters and tumble driers. Only 38 of the 250 households used electric water hearing. While it can be expected that these factors will impact a households consumption and having knowledge of these would aid in classifying households, this is left to further work as the so called \textit{disagregation problem} (see section~\ref{sec:previousWork}) is a popular topic of research in and of itself.

\applianceTable


While visualising the data, it was noted that some households had periods where their consumption vanished for several days. It was manually determined if these were instances of the household simply being unoccupied for a time, or if it was a case of erroneous data. Households were only discarded if the amount of time where their consumption was 0kWh was a significant proportional of the total time for which they were being observed. If a household appeared to be on holiday (meaning their consumption patterns stopped but a small amount of energy was still being used by the house), then the data was kept. And if a given day's readings appeared to be erroneous, then that day was discarded and was replaced by an equivalent day of the week.

The next factor that needed to be considered is the effects of weather, particularly the time of year. Colder temperatures and shorter periods of sunlight cause households to use more electricity in during colder months \cite{DECC}. Although CAR was able to provide a document outlining which appliances need to have their readings adjusted to account for seasonal factors, these did not appear to be well reasoned and didn't include many of the appliances used by households. Since most households were recorded in the colder months between November 2010 and April 2011, and those that were measured for a year didn't appear to significantly change their consumption in the warmer months, season adjustments were disregarded.

%Finally, the project had a delayed start as originally, a dataset created by the IDEAL\footnote{http://www.energyoracle.org/} research group, which would have also gathered information pertaining to household electricity consumption, however as this proved to be unavailable, the HES dataset was used instead.






